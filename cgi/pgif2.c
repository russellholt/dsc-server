#include <stdio.h>main(int argc, char **argv){char *mapfile, bigcmdline[16384];FILE *fp;char line[80],	name[40],	status[40],	coord[20],	xc[10],	yc[10],	syscl[256],	tempfile[50], infile[50],	plotfile[256], outputfile[256],	sourceimage[40],	imagelist[3][40],	word[3][40],	*absdir = "/www/htdocs",	*imagedir = "/status/",	*bigprefix = "big-",/*	*pnmpaste = "/mongo/apps/netpbm/bin/pnmpaste",	*ppmtogif = "/mongo/apps/netpbm/bin/ppmtogif",*/	*pnmpaste = "pnmpaste",	*ppmtogif = "ppmtogif",	*image;    /* points to the current image in the imagelist */int iter=0, x;	bzero(bigcmdline, 16383);	if (argc < 2)	{		fprintf(stderr, "%s: no mapping file to use.\n", argv[0]);		exit(1);	}	else		mapfile = argv[1];	printf("Using map file %s\n", mapfile);	fp = fopen(mapfile, "r");	if (fp)	{		/* unique temp file */		sprintf(tempfile, "/tmp/status-temp%d%d.ppm", iter, getpid());		sprintf(outputfile, "%sstatus-map.gif", imagedir);		/* Read the name of the background image */		fscanf(fp, "%s", sourceimage);		sprintf(plotfile, "%s%s", absdir, sourceimage);		strcpy(infile, plotfile);   /* plotfile to infile */		printf("Source image file is '%s'\n", sourceimage);		/* Read the image and keyword list */		for(x=0; x<3; x++)			fscanf(fp, "%s %s", imagelist[x], word[x]);		while (!feof(fp))		{			fgets(line, 80, fp);			if (feof(fp))   /* premature end ? */				break;			if (line[0] == '#') /* skip comment */				continue;			if (line[0] == '\n')    /* skip blank line */				continue;			sscanf(line, "%s %s %s", name, status, coord);			sscanf(coord, "(%[^(),], %[^(),]", xc, yc);			/* Find the status image to use according to the			 * keyword for this entry (match entry's keyword			 * against the word list)			 */			for(x=0; x<3; x++)				if (strcmp(status, word[x]) == 0)				{					image = imagelist[x];					break;				}			/* Create a command line */			sprintf(syscl, "%s%s %s%s%s %s %s %s ",				iter? "| " : "",				pnmpaste, absdir, imagedir, image, xc, yc,				iter? "" : infile);						strcat(bigcmdline, syscl);			printf("%s\n\n", bigcmdline);			system(syscl);			strcpy(infile, tempfile);   /* copy tempfile to infile */			sprintf(tempfile, "/tmp/status-temp%d%d.ppm", ++iter, getpid());		}		fclose(fp);		/* Create final output file: convert to GIF */		sprintf(syscl, " | %s %s > %s%s", ppmtogif, infile, absdir,			outputfile);		strcat(bigcmdline, syscl);		system(syscl);		printf("\n%s\n", bigcmdline);	}	else	{		fprintf(stderr, "%s: Unable to read mapping file %s\n",			argv[0], mapfile);		exit(1);	}}