/********************************************************************** * reg.c - Bluestone Mall CGI Registration Processor * * compile: cc cgimain.c reg.c util.c -o reg *    binary goes in the cgi-bin directory * * Mails registration data to the address in the first input *   field in the form (it is hidden to the user - to change the *   mailing address, change the HTML) * * Copyright 1995 Destiny Software Corporation * by Russell Holt * Fgrep@aol.com **********************************************************************/#include <stdio.h>#include <stdlib.h>#include "entry.h"#ifndef debug#define debug 0#endif/* DoCGIThing: the 'main' routine; called from cgimain.c */void DoCGIThing(entries, m)entry entries[];int m;	/* max */{char *cl;char syscl[120];int x;FILE *fp;	printf("<title>Registration</title>");    printf("<center><H1>Bluestone Software Mall</H1><HR></center>");	/* Date & time stamp temp file */	system("date > /tmp/REG_TEMP");	/* Append the registration to it */	fp = fopen("/tmp/REG_TEMP", "a");	if (fp)	{		/* print values to temp file */		for (x=1;x<=m;x++)			fprintf(fp, "\n%s = %s\n",entries[x].name, entries[x].val);		fclose(fp);		/* mail to Bluestone admin (or whatever address is given		 * in the HTML form. */		sprintf(syscl, "mail %s < /tmp/SUG_TEMP", entries[0].val);		system(syscl);		printf("Thank you.  You've been added:<p>\n");		for (x=1;x<=m;x++)			printf("<b>%s</b> %s<br>\n",entries[x].name, entries[x].val);	}	else	{		printf("There has been an unexpected error...<p>%c",10);		printf("Please send email to the Bluestone system administrators, ");		printf("at <a href=\"mailto://%s\">%s</a><p>%c", entries[0].val,			entries[0].val, 10);	}	printf("<HR>");	printf("<a href=\"/home.html\"><img align=middle src=\"/gif/med-maze-trans.GIF\">Home</a>");}